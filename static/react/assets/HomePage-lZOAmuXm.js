import{s as Me,j as e,I as Ce,B as le,P as f}from"./index-D74SW2ec.js";import{r as k}from"./react-vendor-DlgOgmxb.js";import{c as we}from"./zustand-DBSE57v9.js";import"./supabase-Br6iVc9W.js";function Se(s,a={}){const{excludeLots:t=!1,ungradedOnly:i=!1,baseOnly:n=!1}=a;let r=[];if(t){const c=["-lot",'-"team lot"','-"player lot"','-"small lot"','-"huge lot"','-"mixed lot"','-"random lot"','-"mystery lot"','-"assorted lot"','-"lot of"','-"lotof"',"-bulk","-bundle",'-"(2)"','-"(3)"','-"(4)"','-"(5)"','-"(6)"','-"(7)"','-"(8)"','-"(9)"','-"(10)"','-"(12)"','-"(15)"','-"(20)"','-"2 cards"','-"3 cards"','-"4 cards"','-"5 cards"','-"6 cards"','-"7 cards"','-"8 cards"','-"9 cards"','-"10 cards"','-"2 card"','-"3 card"','-"4 card"','-"5 card"','-"2x"','-"3x"','-"4x"','-"5x"','-"6x"','-"10x"','-"x cards"','-"x card"','-"count"','-"ct"','-"ct."',"-multi","-multiple","-multiples","-duplicate","-duplicates","-dupe","-dupes",'-"group of"','-"set of"'];r=r.concat(c)}if(i){const c=["-psa",'-"psa 10"','-"psa10"','-"psa 9"','-"psa9"','-"psa graded"','-"psa slab"','-"Professional Sports Authenticator"','-"Professional Authenticator"','-"Pro Sports Authenticator"','-"Certified 10"','-"Certified Gem"','-"Certified Mint"','-"Red Label"',"-lighthouse",'-"Gem Mint 10"','-"Graded 10"',"-bgs",'-"bgs 9"','-"bgs9"','-"bgs 9.5"','-"bgs9.5"',"-beckett",'-"beckett graded"','-"Gem 10"','-"Black Label"','-"Gold Label"','-"Silver Label"',"-subgrades",'-"sub grades"',"-subs",'-"Quad 9.5"','-"quad9"','-"quad 9"','-"True Gem"','-"True Gem+"','-"Gem+"',"-bvg","-sgc",'-"sgc 10"','-"sgc 9"','-"sgc graded"','-"Tuxedo Slab"','-"Black Slab"','-"Green Label"','-"SG LLC"','-"SG Grading"','-"Mint+ 9.5"','-"10 Pristine"',"-csg","-cgc",'-"csg graded"','-"cgc graded"','-"Certified Collectibles Group"','-"CGC Trading Cards"','-"CSG Gem"','-"Pristine 10"','-"Perfect 10"','-"Green Slab"',"-gma",'-"gma graded"','-"gma 10"',"-hga",'-"hga graded"','-"hybrid grading"',"-ksa",'-"ksa graded"',"-pca",'-"pca graded"',"-pgsc","-fgs","-pgi","-pro","-isa","-mnt",'-"MNT Grading"',"-rcg",'-"TCG Grading"',"-bccg","-tag","-pgs","-tga","-ace","-usg","-kmgs","-egs","-agc","-mgs","-slab","-slabbed","-encased","-encapsulated","-holdered","-graded",'-"grade"',"-authenticated",'-"authentic"','-"auto grade"',"-verified","-gem",'-"gem mint"','-"gem10"','-"gem 10"','-"gem-mint"',"-gemmint","-pristine",'-"Mint 10"','-"mint10"','-"Mint 9"','-"mint9"','-"mt 10"','-"10 mt"','-"Mint+"','-"NM-MT"','-"Slabbed Card"','-"Third-Party Graded"','-"Certified Authentic"','-"Pro Graded"','-"Slabbed up"','-"In case"','-"Graded Rookie"','-"Graded RC"','-"Gem Rookie"','-"Gem RC"','-"population"','-"pop report"','-"pop 1"','-"pop1"','-"card saver"',"-cardsaver",'-"semi rigid"','-"semi-rigid"','-"one touch"','-"one-touch"',"-mag",'-"mag case"'];r=r.concat(c)}if(n){const c=["-refractors","-red","-aqua","-blue","-magenta","-yellow","-lot","-x-fractors","-xfractors","-helix","-superfractor","-x-fractor","-logofractor","-stars","-hyper","-all","-etch","-silver","-variation","-variations","-refractor","-prism","-prizm","-xfractor","-gilded",'-"buy-back"',"-buyback","-SP","-sp",'-"short print"','-"Short Print"',"-ssp","-SSP",'-"super short print"','-"Super Short Print"',"-foil","-shimmer","-lava","-wave","-raywave","-speckle","-mojo","-sapphire","-ice","-cracked","-checker","-optic","-paper","-sepia",'-"negative refractor"',"-green","-orange","-gold","-purple","-pink","-fuchsia","-teal","-sky","-lime","-bronze","-copper","-black","-white"];r=r.concat(c)}let h=s;return r.length>0&&(h=`${s} ${r.join(" ")}`),h}function V(s){return s==null||isNaN(s)?"$-.--":"$"+s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function G(s){return s?s.total_price??(s.extracted_price||0)+(s.extracted_shipping||0):0}function ce(s){if(!s||s.length===0)return[];if(s.length<4)return[...s];const a=[...s].sort((b,A)=>b-A),t=a.length,i=Math.floor(t*.25),n=Math.floor(t*.75),r=a[i],h=a[n],c=h-r,p=r-1.5*c,g=h+1.5*c;return s.filter(b=>b>=p&&b<=g)}function oe(s){if(s==null)return"";const a=document.createElement("div");return a.textContent=s,a.innerHTML}function Te(s){if(!s||s.length===0)return 0;const a=s.reduce((n,r)=>n+r,0)/s.length,i=s.map(n=>Math.pow(n-a,2)).reduce((n,r)=>n+r,0)/s.length;return Math.sqrt(i)}function de(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function he(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}function Ae(s,a){if(!s||s.length===0||!a||a<=0)return{value:null,medianAsking:null};const t=s.filter(g=>(g.buying_format||"").toLowerCase().includes("buy it now")).map(g=>G(g)).filter(g=>g>0);if(t.length===0)return{value:null,medianAsking:null};const i=ce(t),r=[...i.length>0?i:t].sort((g,j)=>g-j),h=Math.floor(r.length/2),c=r.length%2!==0?r[h]:(r[h-1]+r[h])/2,p=(c-a)/a*100;return{value:Math.round(p*10)/10,medianAsking:Math.round(c*100)/100}}function Le(s){if(!s||s.length===0)return{value:null,stdDev:null,mean:null};const a=s.map(p=>G(p)).filter(p=>p>0);if(a.length<2)return{value:100,stdDev:0,mean:a[0]||0};const t=ce(a),i=t.length>=2?t:a,n=i.reduce((p,g)=>p+g,0)/i.length,r=Te(i),h=n>0?r/n*100:0,c=Math.round(100/(1+h/100));return{value:Math.min(100,Math.max(0,c)),stdDev:Math.round(r*100)/100,mean:Math.round(n*100)/100}}function Pe(s,a){if(s==null||a===null||a===void 0)return{value:null,ratio:null,band:"unknown"};if(a===0&&s===0)return{value:50,ratio:0,band:"unknown"};if(a===0)return{value:100,ratio:1/0,band:"high"};const t=s/a;let i;t>=1?i=Math.min(100,75+Math.log10(t+1)*25):t>=.5?i=50+(t-.5)*50:t>=.2?i=25+(t-.2)/.3*25:i=t/.2*25;let n;return t>=1?n="high":t>=.5?n="moderate":t>=.2?n="low":n="very-low",{value:Math.round(i),ratio:Math.round(t*100)/100,band:n}}function ae(s,a){if(a==null)return{color:"var(--subtle-text-color)",bgColor:"var(--background-color)",label:"N/A",description:"Insufficient data",icon:"‚ùì"};switch(s){case"pressure":return Re(a);case"confidence":return Fe(a);case"liquidity":return _e(a);default:return{color:"var(--subtle-text-color)",bgColor:"var(--background-color)",label:"Unknown",description:"Unknown metric type",icon:"‚ùì"}}}function Re(s){return s<0?{color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",label:"Below FMV",description:"Sellers asking below market value - potential deals available",icon:"üí∞"}:s<=15?{color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",label:"Healthy",description:"Asking prices align well with recent sales",icon:"‚úÖ"}:s<=30?{color:"#ffc107",bgColor:"rgba(255, 193, 7, 0.1)",label:"Optimistic",description:"Sellers slightly optimistic - room for negotiation",icon:"üí¨"}:s<=50?{color:"#fd7e14",bgColor:"rgba(253, 126, 20, 0.1)",label:"Resistance",description:"Significant gap between asking and sold prices",icon:"‚ö†Ô∏è"}:{color:"#dc3545",bgColor:"rgba(220, 53, 69, 0.1)",label:"Unrealistic",description:"Sellers asking well above what market will bear",icon:"üö´"}}function Fe(s){return s>=80?{color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",label:"High",description:"Very consistent pricing - FMV is reliable",icon:"üéØ"}:s>=60?{color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",label:"Good",description:"Reasonably consistent pricing",icon:"‚úÖ"}:s>=40?{color:"#ffc107",bgColor:"rgba(255, 193, 7, 0.1)",label:"Moderate",description:"Some price variance - FMV is estimate",icon:"üìä"}:s>=20?{color:"#fd7e14",bgColor:"rgba(253, 126, 20, 0.1)",label:"Low",description:"High price variance - use FMV with caution",icon:"‚ö†Ô∏è"}:{color:"#dc3545",bgColor:"rgba(220, 53, 69, 0.1)",label:"Very Low",description:"Prices vary widely - FMV unreliable",icon:"‚ùó"}}function _e(s){return s>=75?{color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",label:"High",description:"Cards selling faster than being listed",icon:"üî•"}:s>=50?{color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",label:"Moderate",description:"Balanced market activity",icon:"‚öñÔ∏è"}:s>=25?{color:"#ffc107",bgColor:"rgba(255, 193, 7, 0.1)",label:"Low",description:"More supply than demand",icon:"üìâ"}:{color:"#dc3545",bgColor:"rgba(220, 53, 69, 0.1)",label:"Very Low",description:"Oversupplied market - slow sales expected",icon:"üê¢"}}function Ve(s,a,t){if(!s||s<=0)return null;let i=.15,n=.15;(a==null?void 0:a.value)!==null&&(a.value<0?(i=.1,n=.05):a.value>30&&(i=.2,n=.1)),(t==null?void 0:t.value)!==null&&(t.value>=75?(i=Math.max(i-.05,.05),n=Math.min(n+.05,.25)):t.value<25&&(i=Math.min(i+.05,.3),n=Math.max(n-.05,.05)));const r=s*(1-i),h=s*(1+n),c=p=>{const g=Math.ceil(p);return Math.max(g,1)-.01};return{quickSale:c(r),target:Math.round(s*100)/100,patientSale:c(h),rangeMin:Math.round(r*100)/100,rangeMax:Math.round(h*100)/100,quickDiscount:Math.round(i*100),patientPremium:Math.round(n*100)}}function De(s){const{pressure:a,confidence:t,liquidity:i}=s;let n=0;return(a==null?void 0:a.value)!==null&&(a.value<0?n+=3:a.value<=15?n+=2:a.value<=30&&(n+=1)),(t==null?void 0:t.value)!==null&&(t.value>=70?n+=3:t.value>=50?n+=2:t.value>=30&&(n+=1)),(i==null?void 0:i.value)!==null&&(i.value>=75?n+=3:i.value>=50?n+=2:i.value>=25&&(n+=1)),n>=7?{tier:1,label:"Excellent",color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",icon:"üåü",description:"Great market conditions for both buyers and sellers"}:n>=5?{tier:2,label:"Good",color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",icon:"‚úÖ",description:"Favorable market conditions"}:n>=3?{tier:3,label:"Fair",color:"#ffc107",bgColor:"rgba(255, 193, 7, 0.1)",icon:"‚öñÔ∏è",description:"Mixed market signals - proceed with analysis"}:n>=1?{tier:4,label:"Challenging",color:"#fd7e14",bgColor:"rgba(253, 126, 20, 0.1)",icon:"‚ö†Ô∏è",description:"Difficult market conditions - be cautious"}:{tier:5,label:"Poor",color:"#dc3545",bgColor:"rgba(220, 53, 69, 0.1)",icon:"‚õî",description:"Unfavorable market conditions"}}function Be(s,a){const{pressure:t,confidence:i,liquidity:n}=a,r={collector:"",seller:"",flipper:""};return(t==null?void 0:t.value)!==null?t.value<0?r.collector="Good time to add to your collection - sellers are pricing competitively.":t.value<=15?r.collector="Fair pricing available. Look for listings near FMV.":t.value<=30?r.collector="Many listings overpriced. Make offers below asking price.":r.collector="Sellers asking too much. Wait for better deals or make low offers.":r.collector="Review individual listings to find fair deals.",(n==null?void 0:n.value)!==null&&(t==null?void 0:t.value)!==null?n.value>=75?t.value<=15?r.seller="Strong demand! Price at FMV for quick sales, slightly above for max value.":r.seller="Despite high demand, price competitively - market is saturated with high asks.":n.value>=50?r.seller="Moderate demand. Price at or slightly below FMV for best results.":r.seller="Slow market. Price 10-15% below FMV for realistic sale timeframe.":r.seller="Price near FMV and monitor market response.",(i==null?void 0:i.value)!==null&&(t==null?void 0:t.value)!==null?t.value<0&&i.value>=60?r.flipper="Potential flip opportunity! Underpriced listings available with reliable FMV.":i.value<40?r.flipper="Risky flip - wide price variance makes profit estimation difficult.":t.value>30?r.flipper="Limited flip potential - asking prices already above what buyers will pay.":(n==null?void 0:n.value)!==null&&n.value<25?r.flipper="Slow turnover - capital may be tied up for extended period.":r.flipper="Modest flip potential. Focus on listings 15%+ below FMV.":r.flipper="Gather more market data before committing capital.",r}const ne=async()=>{try{const{data:{session:s}}=await Me.auth.getSession();if(s!=null&&s.access_token)return{Authorization:`Bearer ${s.access_token}`}}catch(s){console.warn("[searchStore] Failed to get auth session:",s)}return{}},q=we((s,a)=>({query:"",filters:{excludeLots:!1,ungradedOnly:!1,baseOnly:!1},soldListings:[],activeListings:[],stats:null,fmv:null,loading:!1,loadingComps:!1,loadingActive:!1,loadingFmv:!1,loadingMarketAnalysis:!1,error:null,showAllActive:!1,marketMetrics:null,marketTier:null,marketAdvice:null,pricingRecommendations:null,marketMessage:null,setQuery:t=>s({query:t}),setFilters:t=>s(i=>({filters:{...i.filters,...t}})),toggleFilter:t=>s(i=>({filters:{...i.filters,[t]:!i.filters[t]}})),setShowAllActive:t=>s({showAllActive:t}),toggleShowAllActive:()=>s(t=>({showAllActive:!t.showAllActive})),search:async()=>{var r,h,c,p,g,j;const{query:t,filters:i}=a();if(!t.trim()){s({error:"Please enter a search query"});return}s({loading:!0,error:null,soldListings:[],activeListings:[],stats:null,fmv:null,showAllActive:!1,marketMetrics:null,marketTier:null,marketAdvice:null,pricingRecommendations:null,marketMessage:null});const n=Se(t,i);try{const b=await ne();s({loadingComps:!0}),console.log("[searchStore] Fetching sold listings...");const A=new URLSearchParams({query:n,pages:"1",delay:"2",ungraded_only:String(i.ungradedOnly)}),w=await fetch(`/comps?${A}`,{headers:b});if(!w.ok){const u=await w.text();if(w.status===429){try{if(((r=JSON.parse(u).error)==null?void 0:r.code)==="SEARCH_LIMIT_EXCEEDED")throw new Error("Search limit exceeded. Upgrade your plan for more searches.")}catch(x){if(x.message.includes("Search limit"))throw x}throw new Error("Rate limit exceeded. Please try again later.")}if(w.status===422)try{if(((c=(h=JSON.parse(u).detail)==null?void 0:h[0])==null?void 0:c.type)==="string_too_long")throw new Error("Search query is too long. Try using fewer filters or a shorter search term.")}catch(x){if(x.message.includes("too long"))throw x}throw new Error(`Failed to fetch sold listings: ${w.status}`)}const L=await w.json();s({soldListings:L.items||[],stats:{min_price:L.min_price,max_price:L.max_price,avg_price:L.avg_price,count:((p=L.items)==null?void 0:p.length)||0},loadingComps:!1}),console.log("[searchStore] Fetched",((g=L.items)==null?void 0:g.length)||0,"sold listings"),s({loadingFmv:!0}),console.log("[searchStore] Calculating FMV...");const m=await fetch("/fmv",{method:"POST",headers:{"Content-Type":"application/json",...b},body:JSON.stringify({items:L.items||[]})});if(!m.ok)console.warn("[searchStore] FMV calculation failed:",m.status),s({fmv:null,loadingFmv:!1});else{const u=await m.json();s({fmv:{market_value:u.market_value||u.expected_high,quick_sale:u.quick_sale||u.expected_low,patient_sale:u.patient_sale||u.expected_high,expected_low:u.expected_low,expected_high:u.expected_high,count:u.count},loadingFmv:!1}),console.log("[searchStore] FMV calculated:",u.market_value||u.expected_high)}s({loadingActive:!0}),console.log("[searchStore] Fetching active listings...");const l=new URLSearchParams({query:n,pages:"1",delay:"2"});try{const u=await fetch(`/active?${l}`,{headers:b});if(!u.ok)console.warn("[searchStore] Active listings fetch failed:",u.status),s({activeListings:[],loadingActive:!1});else{const x=await u.json();s({activeListings:x.items||[],loadingActive:!1}),console.log("[searchStore] Fetched",((j=x.items)==null?void 0:j.length)||0,"active listings")}}catch(u){console.warn("[searchStore] Active listings error:",u),s({activeListings:[],loadingActive:!1})}}catch(b){console.error("[searchStore] Search error:",b),s({error:b.message})}finally{s({loading:!1,loadingComps:!1,loadingFmv:!1,loadingActive:!1})}},getFilteredActiveListings:()=>{const{activeListings:t,fmv:i,showAllActive:n}=a();if(!t||t.length===0)return[];let r=t.filter(h=>{const p=(h.buying_format||"").toLowerCase().includes("buy it now"),g=G(h);return p&&g>0});return!n&&(i!=null&&i.market_value)&&(r=r.filter(h=>G(h)<=i.market_value)),r.sort((h,c)=>G(h)-G(c)),r},getDealsCount:()=>{const{activeListings:t,fmv:i}=a();return!t||!(i!=null&&i.market_value)?0:t.filter(n=>{const h=(n.buying_format||"").toLowerCase().includes("buy it now"),c=G(n);return h&&c>0&&c<=i.market_value}).length},hasResults:()=>{const{soldListings:t}=a();return t&&t.length>0},hasFmv:()=>{const{fmv:t}=a();return t&&(t.market_value||t.expected_high)},hasMarketMetrics:()=>{const{marketMetrics:t}=a();return t!==null},calculateMarketMetrics:()=>{const{soldListings:t,activeListings:i,fmv:n}=a();if(!t||t.length===0){console.log("[searchStore] Cannot calculate market metrics - no sold listings");return}s({loadingMarketAnalysis:!0});try{const r=(n==null?void 0:n.market_value)||(n==null?void 0:n.expected_high),h=Ae(i,r),c=Le(t),p=Pe(t.length,(i==null?void 0:i.length)||0),g={pressure:h,confidence:c,liquidity:p},j=De(g),b=Be(j,g),A=r?Ve(r,h,p):null;s({marketMetrics:g,marketTier:j,marketAdvice:b,pricingRecommendations:A,loadingMarketAnalysis:!1}),console.log("[searchStore] Market metrics calculated:",{pressure:h.value,confidence:c.value,liquidity:p.value,tier:j.label})}catch(r){console.error("[searchStore] Error calculating market metrics:",r),s({loadingMarketAnalysis:!1})}},fetchMarketMessage:async()=>{const{marketTier:t,fmv:i,soldListings:n,activeListings:r}=a();if(!t||!i){console.log("[searchStore] Cannot fetch market message - missing tier or FMV");return}try{const h=await ne(),c=await fetch("/market-message",{method:"POST",headers:{"Content-Type":"application/json",...h},body:JSON.stringify({tier:t.tier,fmv:i.market_value||i.expected_high,sold_count:(n==null?void 0:n.length)||0,active_count:(r==null?void 0:r.length)||0})});if(c.ok){const p=await c.json();s({marketMessage:p}),console.log("[searchStore] Market message fetched:",p)}else console.warn("[searchStore] Market message fetch failed:",c.status)}catch(h){console.warn("[searchStore] Error fetching market message:",h)}},clearSearch:()=>s({query:"",soldListings:[],activeListings:[],stats:null,fmv:null,error:null,showAllActive:!1,loading:!1,loadingComps:!1,loadingActive:!1,loadingFmv:!1,loadingMarketAnalysis:!1,marketMetrics:null,marketTier:null,marketAdvice:null,pricingRecommendations:null,marketMessage:null}),clearResults:()=>s({soldListings:[],activeListings:[],stats:null,fmv:null,error:null,showAllActive:!1,marketMetrics:null,marketTier:null,marketAdvice:null,pricingRecommendations:null,marketMessage:null}),clearError:()=>s({error:null})}));function me({className:s=""}){const{query:a,setQuery:t,filters:i,toggleFilter:n,search:r,clearSearch:h,loading:c}=q(),p=k.useCallback(b=>{b.preventDefault(),a.trim()&&r()},[a,r]),g=k.useCallback(b=>{b.key==="Enter"&&p(b)},[p]),j=k.useCallback(b=>{t(b.target.value)},[t]);return e.jsxs("form",{className:`search-form ${s}`,onSubmit:p,role:"search",children:[e.jsx("div",{className:"search-input-container",children:e.jsx(Ce,{type:"text",value:a,onChange:j,onKeyDown:g,placeholder:"Search for a card (e.g., 2020 Topps Chrome Luis Robert RC)",className:"search-input","aria-label":"Search query",iconLeft:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.35-4.35"})]})})}),e.jsxs("div",{className:"search-filters",role:"group","aria-label":"Search filters",children:[e.jsxs("label",{className:"search-filter-checkbox",title:"Exclude listings that contain multiple cards (lots, bundles, 2x, 3x, etc.)",children:[e.jsx("input",{type:"checkbox",checked:i.excludeLots,onChange:()=>n("excludeLots")}),e.jsx("span",{className:"checkbox-label",children:"Exclude Lots"}),e.jsx("span",{className:"tooltip-icon","aria-hidden":"true",children:"‚ìò"}),e.jsx("span",{className:"tooltip-text",children:"Filter out multi-card listings, bundles, and lots"})]}),e.jsxs("label",{className:"search-filter-checkbox",title:"Only show raw/ungraded cards (excludes PSA, BGS, SGC, etc.)",children:[e.jsx("input",{type:"checkbox",checked:i.ungradedOnly,onChange:()=>n("ungradedOnly")}),e.jsx("span",{className:"checkbox-label",children:"Raw Only"}),e.jsx("span",{className:"tooltip-icon","aria-hidden":"true",children:"‚ìò"}),e.jsx("span",{className:"tooltip-text",children:"Exclude all graded cards (PSA, BGS, SGC, etc.)"})]}),e.jsxs("label",{className:"search-filter-checkbox",title:"Exclude parallels, refractors, variations, and short prints",children:[e.jsx("input",{type:"checkbox",checked:i.baseOnly,onChange:()=>n("baseOnly")}),e.jsx("span",{className:"checkbox-label",children:"Base Only"}),e.jsx("span",{className:"tooltip-icon","aria-hidden":"true",children:"‚ìò"}),e.jsx("span",{className:"tooltip-text",children:"Exclude parallels, refractors, and variations"})]})]}),e.jsxs("div",{className:"search-actions",children:[e.jsx(le,{type:"submit",variant:"primary",size:"lg",loading:c,disabled:!a.trim(),className:"search-button",children:c?"Searching...":"Search"}),e.jsx(le,{type:"button",variant:"secondary",size:"lg",onClick:h,disabled:c,className:"search-clear-button",children:"Clear"})]})]})}me.propTypes={className:f.string};function ue({className:s=""}){const{soldListings:a,loadingComps:t}=q(),[i,n]=k.useState("price"),[r,h]=k.useState("desc"),[c,p]=k.useState(null),g=k.useCallback(m=>{i===m?h(l=>l==="asc"?"desc":"asc"):(n(m),h("desc"))},[i]),j=k.useMemo(()=>!a||a.length===0?[]:[...a].sort((l,u)=>{let x=0;switch(i){case"title":x=(l.title||"").localeCompare(u.title||"");break;case"price":x=(l.total_price||0)-(u.total_price||0);break;case"item_id":x=(l.item_id||"").localeCompare(u.item_id||"");break;default:x=0}return r==="asc"?x:-x}),[a,i,r]),b=m=>i!==m?null:r==="asc"?" ‚ñ≤":" ‚ñº",A=k.useCallback(m=>{p(l=>l===m?null:m)},[]),w=m=>de()&&m.deep_link?m.deep_link:m.link,L=()=>he()?"_self":"_blank";return t?e.jsxs("div",{className:`listings-table-container ${s}`,children:[e.jsx("h3",{className:"listings-table-title",children:"Recently Sold Listings"}),e.jsxs("div",{className:"listings-table-loading",children:[e.jsx("div",{className:"spinner spinner-md spinner-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading sold listings..."})}),e.jsx("span",{children:"Loading sold listings..."})]})]}):!a||a.length===0?e.jsxs("div",{className:`listings-table-container ${s}`,children:[e.jsx("h3",{className:"listings-table-title",children:"Recently Sold Listings"}),e.jsxs("div",{className:"listings-table-empty",children:[e.jsx("div",{className:"listings-empty-icon",children:"üì≠"}),e.jsx("p",{className:"listings-empty-text",children:"No recently sold listings found"}),e.jsx("p",{className:"listings-empty-hint",children:"Try adjusting your search terms or filters"})]})]}):e.jsxs("div",{className:`listings-table-container ${s}`,children:[e.jsx("h3",{className:"listings-table-title",children:"Recently Sold Listings"}),e.jsxs("p",{className:"listings-table-count",children:["üìä ",a.length," results found"]}),e.jsx("div",{className:"listings-table-wrapper",children:e.jsxs("table",{className:"listings-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{onClick:()=>g("title"),className:"sortable-header",role:"columnheader","aria-sort":i==="title"?r==="asc"?"ascending":"descending":"none",children:["Title",b("title")]}),e.jsxs("th",{onClick:()=>g("price"),className:"sortable-header",role:"columnheader","aria-sort":i==="price"?r==="asc"?"ascending":"descending":"none",children:["Price",b("price")]}),e.jsxs("th",{onClick:()=>g("item_id"),className:"sortable-header",role:"columnheader","aria-sort":i==="item_id"?r==="asc"?"ascending":"descending":"none",children:["Item ID",b("item_id")]})]})}),e.jsx("tbody",{children:j.map(m=>e.jsxs("tr",{onClick:()=>A(m.item_id),className:c===m.item_id?"row-selected":"",children:[e.jsx("td",{className:"listing-title-cell",children:oe(m.title)}),e.jsx("td",{className:"listing-price-cell",children:V(m.total_price)}),e.jsx("td",{className:"listing-id-cell",children:e.jsx("a",{href:w(m),target:L(),rel:"noopener noreferrer",onClick:l=>l.stopPropagation(),className:"listing-link",children:m.item_id})})]},m.item_id))})]})})]})}ue.propTypes={className:f.string};function ge({className:s=""}){const{activeListings:a,fmv:t,loadingActive:i,getFilteredActiveListings:n}=q(),[r,h]=k.useState(!1),[c,p]=k.useState("discount"),[g,j]=k.useState("desc"),[b,A]=k.useState(null),w=(t==null?void 0:t.marketValue)||0,L=k.useMemo(()=>r?a||[]:n(),[a,r,n]),m=k.useCallback(v=>{if(!w||w===0)return 0;const S=G(v);return(w-S)/w*100},[w]),l=k.useCallback(v=>{c===v?j(S=>S==="asc"?"desc":"asc"):(p(v),j("desc"))},[c]),u=k.useMemo(()=>!L||L.length===0?[]:[...L].sort((S,R)=>{var E,D;let F=0;switch(c){case"title":F=(S.title||"").localeCompare(R.title||"");break;case"price":F=G(S)-G(R);break;case"discount":F=m(S)-m(R);break;case"type":F=(((E=S.buying_options)==null?void 0:E[0])||"").localeCompare(((D=R.buying_options)==null?void 0:D[0])||"");break;case"item_id":F=(S.item_id||"").localeCompare(R.item_id||"");break;default:F=0}return g==="asc"?F:-F}),[L,c,g,m]),x=v=>c!==v?null:g==="asc"?" ‚ñ≤":" ‚ñº",d=k.useCallback(v=>{A(S=>S===v?null:v)},[]),o=v=>de()&&v.deep_link?v.deep_link:v.link,P=()=>he()?"_self":"_blank",T=v=>{const S=v>=0?"+":"",R=v>=0?"discount-positive":"discount-negative";return{text:`${S}${v.toFixed(1)}%`,colorClass:R}},y=v=>{if(!v.buying_options||v.buying_options.length===0)return"Unknown";const S=v.buying_options[0];return S==="FIXED_PRICE"?"Buy It Now":S==="AUCTION"?"Auction":S==="BEST_OFFER"?"Best Offer":S};return i?e.jsxs("div",{className:`listings-table-container ${s}`,children:[e.jsx("h3",{className:"listings-table-title",children:"Active Listings"}),e.jsxs("div",{className:"listings-table-loading",children:[e.jsx("div",{className:"spinner spinner-md spinner-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading active listings..."})}),e.jsx("span",{children:"Loading active listings..."})]})]}):!a||a.length===0?e.jsxs("div",{className:`listings-table-container ${s}`,children:[e.jsx("h3",{className:"listings-table-title",children:"Active Listings"}),e.jsxs("div",{className:"listings-table-empty",children:[e.jsx("div",{className:"listings-empty-icon",children:"üõí"}),e.jsx("p",{className:"listings-empty-text",children:"No active listings found"}),e.jsx("p",{className:"listings-empty-hint",children:"Try adjusting your search terms or filters"})]})]}):!r&&u.length===0?e.jsxs("div",{className:`listings-table-container ${s}`,children:[e.jsx("h3",{className:"listings-table-title",children:"Active Listings"}),e.jsx("div",{className:"listings-table-controls",children:e.jsxs("label",{className:"listings-toggle-label",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:v=>h(v.target.checked),className:"listings-toggle-checkbox"}),e.jsxs("span",{children:["See All (",a.length," total)"]})]})}),e.jsxs("div",{className:"listings-table-empty",children:[e.jsx("div",{className:"listings-empty-icon",children:"üí∞"}),e.jsx("p",{className:"listings-empty-text",children:"No listings below Market Value"}),e.jsx("p",{className:"listings-empty-hint",children:'Enable "See All" to view all active listings'})]})]}):e.jsxs("div",{className:`listings-table-container ${s}`,children:[e.jsx("h3",{className:"listings-table-title",children:"Active Listings"}),e.jsxs("div",{className:"listings-table-controls",children:[e.jsxs("label",{className:"listings-toggle-label",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:v=>h(v.target.checked),className:"listings-toggle-checkbox"}),e.jsxs("span",{children:["See All (",a.length," total)"]})]}),e.jsxs("p",{className:"listings-table-count",children:["üè∑Ô∏è ",u.length," ",r?"listings":"below market value"]})]}),e.jsx("div",{className:"listings-table-wrapper",children:e.jsxs("table",{className:"listings-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{onClick:()=>l("title"),className:"sortable-header",role:"columnheader","aria-sort":c==="title"?g==="asc"?"ascending":"descending":"none",children:["Title",x("title")]}),e.jsxs("th",{onClick:()=>l("price"),className:"sortable-header",role:"columnheader","aria-sort":c==="price"?g==="asc"?"ascending":"descending":"none",children:["Price",x("price")]}),e.jsxs("th",{onClick:()=>l("discount"),className:"sortable-header",role:"columnheader","aria-sort":c==="discount"?g==="asc"?"ascending":"descending":"none",children:["Discount",x("discount")]}),e.jsxs("th",{onClick:()=>l("type"),className:"sortable-header",role:"columnheader","aria-sort":c==="type"?g==="asc"?"ascending":"descending":"none",children:["Type",x("type")]}),e.jsxs("th",{onClick:()=>l("item_id"),className:"sortable-header",role:"columnheader","aria-sort":c==="item_id"?g==="asc"?"ascending":"descending":"none",children:["Item ID",x("item_id")]})]})}),e.jsx("tbody",{children:u.map(v=>{const S=m(v),{text:R,colorClass:F}=T(S);return e.jsxs("tr",{onClick:()=>d(v.item_id),className:b===v.item_id?"row-selected":"",children:[e.jsx("td",{className:"listing-title-cell",children:oe(v.title)}),e.jsx("td",{className:"listing-price-cell",children:V(G(v))}),e.jsx("td",{className:`listing-discount-cell ${F}`,children:w>0?R:"N/A"}),e.jsx("td",{className:"listing-type-cell",children:y(v)}),e.jsx("td",{className:"listing-id-cell",children:e.jsx("a",{href:o(v),target:P(),rel:"noopener noreferrer",onClick:E=>E.stopPropagation(),className:"listing-link",children:v.item_id})})]},v.item_id)})})]})})]})}ge.propTypes={className:f.string};function pe({className:s=""}){const{stats:a,loadingComps:t}=q();return t?e.jsxs("div",{className:`stats-grid ${s}`,children:[e.jsxs("div",{className:"stats-item stats-skeleton",children:[e.jsx("span",{className:"stats-label",children:"Minimum"}),e.jsx("span",{className:"stats-value skeleton-text",children:"Loading..."})]}),e.jsxs("div",{className:"stats-item stats-skeleton",children:[e.jsx("span",{className:"stats-label",children:"Average"}),e.jsx("span",{className:"stats-value skeleton-text",children:"Loading..."})]}),e.jsxs("div",{className:"stats-item stats-skeleton",children:[e.jsx("span",{className:"stats-label",children:"Maximum"}),e.jsx("span",{className:"stats-value skeleton-text",children:"Loading..."})]})]}):!a||a.count===0?e.jsxs("div",{className:`stats-grid stats-empty ${s}`,children:[e.jsxs("div",{className:"stats-item",children:[e.jsx("span",{className:"stats-label",children:"Minimum"}),e.jsx("span",{className:"stats-value stats-value-empty",children:"--"})]}),e.jsxs("div",{className:"stats-item",children:[e.jsx("span",{className:"stats-label",children:"Average"}),e.jsx("span",{className:"stats-value stats-value-empty",children:"--"})]}),e.jsxs("div",{className:"stats-item",children:[e.jsx("span",{className:"stats-label",children:"Maximum"}),e.jsx("span",{className:"stats-value stats-value-empty",children:"--"})]})]}):e.jsxs("div",{className:`stats-grid ${s}`,children:[e.jsxs("div",{className:"stats-item stats-item-min",children:[e.jsx("span",{className:"stats-label",children:"Minimum"}),e.jsx("span",{className:"stats-value",children:V(a.min)}),e.jsx("span",{className:"stats-sublabel",children:"Lowest sale"})]}),e.jsxs("div",{className:"stats-item stats-item-avg",children:[e.jsx("span",{className:"stats-label",children:"Average"}),e.jsx("span",{className:"stats-value stats-value-main",children:V(a.avg)}),e.jsxs("span",{className:"stats-sublabel",children:["Mean of ",a.count," sales"]})]}),e.jsxs("div",{className:"stats-item stats-item-max",children:[e.jsx("span",{className:"stats-label",children:"Maximum"}),e.jsx("span",{className:"stats-value",children:V(a.max)}),e.jsx("span",{className:"stats-sublabel",children:"Highest sale"})]})]})}pe.propTypes={className:f.string};function fe({className:s=""}){const{fmv:a,loadingComps:t}=q();return t?e.jsxs("div",{className:`fmv-display ${s}`,children:[e.jsx("h3",{className:"fmv-title",children:"Fair Market Value"}),e.jsxs("div",{className:"fmv-grid",children:[e.jsxs("div",{className:"fmv-item fmv-skeleton",children:[e.jsx("span",{className:"fmv-label",children:"Quick Sale"}),e.jsx("span",{className:"fmv-value skeleton-text",children:"Loading..."})]}),e.jsxs("div",{className:"fmv-item fmv-item-main fmv-skeleton",children:[e.jsx("span",{className:"fmv-label",children:"Market Value"}),e.jsx("span",{className:"fmv-value skeleton-text",children:"Loading..."})]}),e.jsxs("div",{className:"fmv-item fmv-skeleton",children:[e.jsx("span",{className:"fmv-label",children:"Patient Sale"}),e.jsx("span",{className:"fmv-value skeleton-text",children:"Loading..."})]})]})]}):!a||!a.marketValue?e.jsxs("div",{className:`fmv-display fmv-empty ${s}`,children:[e.jsx("h3",{className:"fmv-title",children:"Fair Market Value"}),e.jsxs("div",{className:"fmv-grid",children:[e.jsxs("div",{className:"fmv-item",children:[e.jsx("span",{className:"fmv-label",children:"Quick Sale"}),e.jsx("span",{className:"fmv-value fmv-value-empty",children:"--"})]}),e.jsxs("div",{className:"fmv-item fmv-item-main",children:[e.jsx("span",{className:"fmv-label",children:"Market Value"}),e.jsx("span",{className:"fmv-value fmv-value-empty",children:"--"})]}),e.jsxs("div",{className:"fmv-item",children:[e.jsx("span",{className:"fmv-label",children:"Patient Sale"}),e.jsx("span",{className:"fmv-value fmv-value-empty",children:"--"})]})]}),e.jsx("p",{className:"fmv-hint",children:"Search for a card to calculate FMV"})]}):e.jsxs("div",{className:`fmv-display ${s}`,children:[e.jsx("h3",{className:"fmv-title",children:"Fair Market Value"}),e.jsxs("div",{className:"fmv-grid",children:[e.jsxs("div",{className:"fmv-item fmv-item-quick",children:[e.jsx("span",{className:"fmv-label",children:"Quick Sale"}),e.jsx("span",{className:"fmv-value fmv-value-quick",children:V(a.quickSale)}),e.jsx("span",{className:"fmv-sublabel",title:"Sell within 24-48 hours at a discount",children:"üèÉ Fast sale price"})]}),e.jsxs("div",{className:"fmv-item fmv-item-main",children:[e.jsx("span",{className:"fmv-label",children:"Market Value"}),e.jsx("span",{className:"fmv-value fmv-value-market",children:V(a.marketValue)}),e.jsx("span",{className:"fmv-sublabel",title:"Average recent sales price",children:"üí∞ Fair price"})]}),e.jsxs("div",{className:"fmv-item fmv-item-patient",children:[e.jsx("span",{className:"fmv-label",children:"Patient Sale"}),e.jsx("span",{className:"fmv-value fmv-value-patient",children:V(a.patientSale)}),e.jsx("span",{className:"fmv-sublabel",title:"Wait for the right buyer at premium",children:"‚è≥ Maximum price"})]})]})]})}fe.propTypes={className:f.string};function $(s){return s==null||isNaN(s)?"N/A":"$"+s.toFixed(2)}function ie(s){if(!s||s.length===0)return[];if(s.length<4)return s;const a=[...s].sort((j,b)=>j-b),t=a.length,i=Math.floor(t*.25),n=Math.floor(t*.75),r=a[i],h=a[n],c=h-r,p=r-1.5*c,g=h+1.5*c;return s.filter(j=>j>=p&&j<=g)}function re(s,a,t,i){const n=new Array(a).fill(0),h=(i-t)/a;return s.forEach(c=>{let p=Math.floor((c-t)/h);p>=a&&(p=a-1),p<0&&(p=0),n[p]++}),n}function qe(s,a,t,i=4,n=60){const r=s.map(c=>({x:a(c),y:t,price:c,r:i,originalY:t})),h=[];for(const c of r){let p=c.originalY,g=!0,j=0,b=0;for(;g&&j<200;){g=!1;for(const A of h){const w=c.x-A.x,L=p-A.y,m=Math.sqrt(w*w+L*L),l=c.r+A.r+1;if(m<l){g=!0;break}}if(g){j++,b=Math.ceil(j/2)*(c.r*2+1);const A=j%2===1?1:-1;if(p=t+A*b,b>n)break}}h.push({x:c.x,y:p,price:c.price,r:c.r})}return h}function Ee(s,a,t,i,n,r){s.beginPath(),s.moveTo(a+r,t),s.lineTo(a+i-r,t),s.quadraticCurveTo(a+i,t,a+i,t+r),s.lineTo(a+i,t+n-r),s.quadraticCurveTo(a+i,t+n,a+i-r,t+n),s.lineTo(a+r,t+n),s.quadraticCurveTo(a,t+n,a,t+n-r),s.lineTo(a,t+r),s.quadraticCurveTo(a,t,a+r,t),s.closePath()}function xe(s,a,t,i,n="rgba(255, 149, 0, 0.95)",r="#ffffff"){s.font="bold 14px sans-serif";const p=s.measureText(a).width+8*2,g=28,j=4;let b=t-p/2;const A=i-g;s.fillStyle=n,Ee(s,b,A,p,g,j),s.fill(),s.fillStyle=r,s.textAlign="center",s.fillText(a,t,i-8)}const te={top:60,right:40,bottom:70,left:40},N={soldBlue:"rgba(0, 122, 255, 0.7)",soldBlueBorder:"rgba(0, 122, 255, 0.9)",activeRed:"rgba(255, 59, 48, 0.6)",activeRedBorder:"rgba(255, 59, 48, 0.9)",fmvGreen:"rgba(52, 199, 89, 0.2)",fmvGreenLight:"rgba(48, 209, 88, 0.15)",axisColor:"#d2d2d7",labelColor:"#6e6e73",textColor:"#1d1d1f",gridColor:"#e5e5ea",crosshairColor:"rgba(255, 149, 0, 0.9)",success:"#34c759",warning:"#ff9500"},Ge=()=>{const s=k.useRef(null),a=k.useRef(null),[t,i]=k.useState(null),[n,r]=k.useState({width:0,height:250}),h=q(m=>m.soldListings),c=q(m=>m.fmv),p=(h==null?void 0:h.map(m=>m.total_price).filter(m=>m>0))||[];k.useEffect(()=>{if(!a.current)return;const m=new ResizeObserver(u=>{for(const x of u){const{width:d}=x.contentRect;d>0&&r(o=>({...o,width:d}))}});m.observe(a.current);const l=a.current.offsetWidth;return l>0&&r(u=>({...u,width:l})),()=>m.disconnect()},[]);const g=k.useCallback(()=>{const m=s.current;if(!m||n.width===0)return;const l=m.getContext("2d"),{width:u,height:x}=n,d={...te},o=u-d.left-d.right,P=x-d.top-d.bottom;m.width=u,m.height=x,l.clearRect(0,0,u,x),l.fillStyle="#f8f9fa",l.fillRect(0,0,u,x),l.fillStyle=N.textColor,l.font="bold 16px system-ui, -apple-system, sans-serif",l.textAlign="center",l.fillText("Fair Market Value Ranges",u/2,25);const T=p.filter(C=>C!=null&&!isNaN(C)&&C>0);if(T.length===0){l.fillStyle=N.labelColor,l.font="16px system-ui, -apple-system, sans-serif",l.textAlign="center",l.fillText("No price data available",u/2,x/2),l.fillText("Run a search to see results",u/2,x/2+25);return}const y=ie(T);if(y.length===0){l.fillStyle=N.labelColor,l.font="16px system-ui, -apple-system, sans-serif",l.textAlign="center",l.fillText("No data after filtering",u/2,x/2);return}const v=Math.min(...y),S=Math.max(...y),R=S-v,F=C=>R===0?u/2:d.left+(C-v)/R*o,E=(c==null?void 0:c.quick_sale)||(c==null?void 0:c.expected_low),D=(c==null?void 0:c.patient_sale)||(c==null?void 0:c.expected_high),O=(c==null?void 0:c.market_value)||D;if(E&&D&&R>0){const C=F(E),I=F(D),Z=l.createLinearGradient(C,d.top,I,x-d.bottom);Z.addColorStop(0,N.fmvGreen),Z.addColorStop(.5,N.fmvGreenLight),Z.addColorStop(1,"rgba(52, 199, 89, 0.1)"),l.shadowColor="rgba(52, 199, 89, 0.3)",l.shadowBlur=8,l.shadowOffsetY=2,l.fillStyle=Z,l.fillRect(C,d.top,I-C,P),l.shadowColor="transparent",l.shadowBlur=0,l.shadowOffsetY=0;const ee=l.createLinearGradient(0,d.top,0,x-d.bottom);ee.addColorStop(0,"rgba(0, 122, 255, 0.8)"),ee.addColorStop(.5,"rgba(52, 199, 89, 0.9)"),ee.addColorStop(1,"rgba(0, 122, 255, 0.6)"),l.strokeStyle=ee,l.lineWidth=3,l.setLineDash([8,4]),l.shadowColor="rgba(0, 122, 255, 0.5)",l.shadowBlur=6,l.beginPath(),l.moveTo(C,d.top),l.lineTo(C,x-d.bottom),l.stroke(),l.beginPath(),l.moveTo(I,d.top),l.lineTo(I,x-d.bottom),l.stroke(),l.setLineDash([]),l.shadowColor="transparent",l.shadowBlur=0,l.fillStyle=N.success,l.font="bold 11px system-ui, -apple-system, sans-serif",l.textAlign="center",l.fillText($(E),C,d.top-8),l.fillText($(D),I,d.top-8)}const z=x/2,J=Math.min(P/2-10,60);if(qe(y,F,z,4,J).map(C=>({...C,y:Math.max(d.top+4,Math.min(x-d.bottom-4,C.y))})).forEach(C=>{l.beginPath(),l.arc(C.x,C.y,C.r,0,2*Math.PI),l.fillStyle=N.soldBlue,l.fill(),l.strokeStyle=N.soldBlueBorder,l.lineWidth=1,l.stroke()}),l.beginPath(),l.moveTo(d.left,x-d.bottom),l.lineTo(u-d.right,x-d.bottom),l.strokeStyle=N.axisColor,l.lineWidth=1,l.stroke(),l.fillStyle=N.labelColor,l.font="11px system-ui, -apple-system, sans-serif",l.textAlign="center",R>0){if(l.fillText("Min",d.left,x-d.bottom+15),l.fillStyle=N.textColor,l.font="bold 12px system-ui, -apple-system, sans-serif",l.fillText($(v),d.left,x-d.bottom+30),l.fillStyle=N.labelColor,l.font="11px system-ui, -apple-system, sans-serif",l.fillText("Max",u-d.right,x-d.bottom+15),l.fillStyle=N.textColor,l.font="bold 12px system-ui, -apple-system, sans-serif",l.fillText($(S),u-d.right,x-d.bottom+30),O&&O>=v&&O<=S){const C=F(O);l.beginPath(),l.moveTo(C,x-d.bottom),l.lineTo(C,x-d.bottom+5),l.strokeStyle=N.warning,l.lineWidth=2,l.stroke(),l.fillStyle=N.labelColor,l.font="11px system-ui, -apple-system, sans-serif",l.textAlign="center",l.fillText("FMV",C,x-d.bottom+15),l.fillStyle=N.warning,l.font="bold 12px system-ui, -apple-system, sans-serif",l.fillText($(O),C,x-d.bottom+30)}}else l.fillText($(v),u/2,x-d.bottom+20),l.fillText("(All prices identical)",u/2,x-d.bottom+35);const W=x-15,X="FMV Range";l.font="11px system-ui, -apple-system, sans-serif";const H=l.measureText(X).width,U=30,Q=5,M=U+Q+H,_=(u-M)/2,B=l.createLinearGradient(_,W-8,_+U,W-8);if(B.addColorStop(0,"rgba(52, 199, 89, 0.3)"),B.addColorStop(1,"rgba(52, 199, 89, 0.5)"),l.fillStyle=B,l.fillRect(_,W-12,U,12),l.strokeStyle="rgba(52, 199, 89, 0.8)",l.lineWidth=1,l.strokeRect(_,W-12,U,12),l.fillStyle=N.textColor,l.textAlign="left",l.fillText(X,_+U+Q,W-3),t!==null&&t>=d.left&&t<=u-d.right){const C=t-d.left,I=v+C/o*R;l.strokeStyle=N.crosshairColor,l.lineWidth=2,l.setLineDash([5,5]),l.beginPath(),l.moveTo(t,d.top),l.lineTo(t,x-d.bottom),l.stroke(),l.setLineDash([]),xe(l,$(I),t,d.top-5)}m.dataset.minPrice=v,m.dataset.maxPrice=S,m.dataset.marginLeft=d.left,m.dataset.marginRight=d.right,m.dataset.innerWidth=o},[n,p,c,t]);k.useEffect(()=>{g()},[g]);const j=k.useCallback(m=>{const l=s.current;if(!l)return;const u=l.getBoundingClientRect(),x=m-u.left,d=parseFloat(l.dataset.marginLeft)||te.left,o=parseFloat(l.dataset.marginRight)||te.right;x>=d&&x<=l.width-o&&i(x)},[]),b=k.useCallback(m=>{j(m.clientX)},[j]),A=k.useCallback(m=>{m.preventDefault(),m.touches.length>0&&j(m.touches[0].clientX)},[j]),w=k.useCallback(()=>{i(null)},[]),L=k.useCallback(m=>{j(m.clientX)},[j]);return e.jsx("div",{className:"chart-canvas-wrapper",ref:a,children:e.jsx("canvas",{ref:s,className:"chart-canvas",style:{cursor:"crosshair"},onMouseMove:b,onMouseLeave:w,onClick:L,onTouchMove:A})})},ve=({defaultBins:s=25})=>{const a=k.useRef(null),t=k.useRef(null),[i,n]=k.useState(null),[r,h]=k.useState(s),[c,p]=k.useState({width:0,height:300}),g=q(d=>d.soldListings),j=q(d=>d.activeListings),b=q(d=>d.fmv);k.useEffect(()=>{if(!t.current)return;const d=new ResizeObserver(P=>{for(const T of P){const{width:y}=T.contentRect;y>0&&p(v=>({...v,width:y}))}});d.observe(t.current);const o=t.current.offsetWidth;return o>0&&p(P=>({...P,width:o})),()=>d.disconnect()},[]),k.useEffect(()=>{window.innerWidth<768&&r===s&&h(10)},[s,r]);const A=k.useCallback(()=>{const d=a.current;if(!d||c.width===0)return;const o=d.getContext("2d"),{width:P,height:T}=c,y={top:40,right:40,bottom:60,left:60},v=P-y.left-y.right,S=T-y.top-y.bottom;d.width=P,d.height=T,o.clearRect(0,0,P,T),o.fillStyle="#f8f9fa",o.fillRect(0,0,P,T);let R=(g==null?void 0:g.map(M=>M.total_price).filter(M=>M>0))||[],F=(j==null?void 0:j.filter(M=>(M.buying_format||"").toLowerCase().includes("buy it now")).map(M=>M.total_price??(M.extracted_price||0)+(M.extracted_shipping||0)).filter(M=>M>0))||[];if(R.length===0&&F.length===0){o.fillStyle=N.textColor,o.font="bold 16px system-ui, -apple-system, sans-serif",o.textAlign="center",o.fillText("No data available for price distribution",P/2,T/2),o.font="14px system-ui, -apple-system, sans-serif",o.fillStyle=N.labelColor,o.fillText("Run a search to see results",P/2,T/2+25);return}R.length>=4&&(R=ie(R)),F.length>=4&&(F=ie(F));const E=[...R,...F],D=Math.min(...E),O=Math.max(...E),z=O-D,J=re(R,r,D,O),Y=re(F,r,D,O),K=Math.max(...J,...Y,1);o.strokeStyle=N.axisColor,o.lineWidth=2,o.beginPath(),o.moveTo(y.left,y.top),o.lineTo(y.left,T-y.bottom),o.stroke(),o.beginPath(),o.moveTo(y.left,T-y.bottom),o.lineTo(P-y.right,T-y.bottom),o.stroke(),o.save(),o.translate(20,T/2),o.rotate(-Math.PI/2),o.fillStyle=N.textColor,o.font="bold 14px system-ui, -apple-system, sans-serif",o.textAlign="center",o.fillText("Number of Sales/Listings",0,0),o.restore(),o.fillStyle=N.textColor,o.font="bold 14px system-ui, -apple-system, sans-serif",o.textAlign="center",o.fillText("Price",P/2,T-10);const W=5;o.fillStyle=N.labelColor,o.font="11px system-ui, -apple-system, sans-serif",o.textAlign="right";for(let M=0;M<=W;M++){const _=T-y.bottom-M/W*S,B=Math.round(M/W*K);o.strokeStyle=N.gridColor,o.lineWidth=1,o.beginPath(),o.moveTo(y.left,_),o.lineTo(P-y.right,_),o.stroke(),o.fillStyle=N.labelColor,o.fillText(B.toString(),y.left-10,_+4)}const X=v/r,H=X*.8,U=X*.1;for(let M=0;M<r;M++){const _=y.left+M*X+U;if(J[M]>0){const B=J[M]/K*S,C=T-y.bottom-B;o.fillStyle=N.soldBlue,o.fillRect(_,C,H,B),o.strokeStyle=N.soldBlueBorder,o.lineWidth=2,o.strokeRect(_,C,H,B)}if(Y[M]>0){const B=Y[M]/K*S,C=T-y.bottom-B,I=H*.15;o.fillStyle=N.activeRed,o.fillRect(_+I,C,H,B),o.strokeStyle=N.activeRedBorder,o.lineWidth=2,o.strokeRect(_+I,C,H,B)}}const Q=(b==null?void 0:b.market_value)||(b==null?void 0:b.expected_high);if(Q&&z>0){const M=y.left+(Q-D)/z*v;o.strokeStyle=N.warning,o.lineWidth=2,o.setLineDash([8,4]),o.beginPath(),o.moveTo(M,y.top),o.lineTo(M,T-y.bottom),o.stroke(),o.setLineDash([]),o.fillStyle=N.warning,o.font="bold 11px system-ui, -apple-system, sans-serif",o.textAlign="center",o.fillText("FMV",M,T-y.bottom+15),o.fillText($(Q),M,T-y.bottom+28)}if(i!==null&&i>=y.left&&i<=P-y.right){const M=i-y.left,_=D+M/v*z;o.strokeStyle=N.crosshairColor,o.lineWidth=2,o.setLineDash([5,5]),o.beginPath(),o.moveTo(i,y.top),o.lineTo(i,T-y.bottom),o.stroke(),o.setLineDash([]),xe(o,$(_),i,y.top-5)}d.dataset.minPrice=D,d.dataset.maxPrice=O,d.dataset.marginLeft=y.left,d.dataset.marginRight=y.right,d.dataset.innerWidth=v},[c,g,j,b,r,i]);k.useEffect(()=>{A()},[A]);const w=k.useCallback(d=>{const o=a.current;if(!o)return;const P=o.getBoundingClientRect(),T=d-P.left,y=parseFloat(o.dataset.marginLeft)||60,v=parseFloat(o.dataset.marginRight)||40;T>=y&&T<=o.width-v&&n(T)},[]),L=k.useCallback(d=>{w(d.clientX)},[w]),m=k.useCallback(d=>{d.preventDefault(),d.touches.length>0&&w(d.touches[0].clientX)},[w]),l=k.useCallback(()=>{n(null)},[]),u=k.useCallback(d=>{h(o=>{const P=o+d;return Math.min(50,Math.max(5,P))})},[]),x=k.useCallback(()=>{const d=window.innerWidth<768;h(d?10:s)},[s]);return e.jsxs("div",{className:"volume-profile-chart",children:[e.jsxs("div",{className:"chart-controls",children:[e.jsx("span",{className:"chart-controls-label",children:"Bars:"}),e.jsx("button",{className:"chart-control-btn",onClick:()=>u(-5),"aria-label":"Decrease bins",children:"‚àí"}),e.jsx("span",{className:"chart-bin-count",children:r}),e.jsx("button",{className:"chart-control-btn",onClick:()=>u(5),"aria-label":"Increase bins",children:"+"}),e.jsx("button",{className:"chart-control-btn chart-control-reset",onClick:x,children:"Reset"})]}),e.jsx("div",{className:"chart-canvas-wrapper",ref:t,children:e.jsx("canvas",{ref:a,className:"chart-canvas",style:{cursor:"crosshair"},onMouseMove:L,onMouseLeave:l,onTouchMove:m})}),e.jsxs("div",{className:"chart-legend",children:[e.jsxs("div",{className:"chart-legend-item",children:[e.jsx("div",{className:"chart-legend-color",style:{background:N.soldBlue,borderColor:N.soldBlueBorder}}),e.jsx("span",{children:"Sold Listings"})]}),e.jsxs("div",{className:"chart-legend-item",children:[e.jsx("div",{className:"chart-legend-color",style:{background:N.activeRed,borderColor:N.activeRedBorder}}),e.jsx("span",{children:"Active Listings"})]})]})]})};ve.propTypes={defaultBins:f.number};function se({title:s,value:a,unit:t="",band:i,min:n=0,max:r=100,subtitle:h,loading:c=!1,infoContent:p}){const[g,j]=k.useState(!1),A=((a!==null?Math.max(n,Math.min(r,a)):0)-n)/(r-n)*100,w=a!==null?Number.isInteger(a)?a:a.toFixed(1):"--";return c?e.jsxs("div",{className:"indicator-card indicator-card-loading",children:[e.jsx("div",{className:"indicator-card-header",children:e.jsx("span",{className:"indicator-card-title",children:s})}),e.jsxs("div",{className:"indicator-card-body",children:[e.jsx("div",{className:"indicator-value-skeleton"}),e.jsx("div",{className:"indicator-bar-skeleton"})]})]}):e.jsxs("div",{className:"indicator-card",style:{"--indicator-color":(i==null?void 0:i.color)||"var(--subtle-text-color)"},children:[e.jsxs("div",{className:"indicator-card-header",children:[e.jsx("span",{className:"indicator-card-title",children:s}),p&&e.jsx("button",{className:"indicator-info-btn",onClick:()=>j(!g),title:"More information","aria-label":`Info about ${s}`,children:"‚ÑπÔ∏è"})]}),e.jsxs("div",{className:"indicator-card-body",children:[e.jsxs("div",{className:"indicator-value-row",children:[e.jsx("span",{className:"indicator-icon",children:(i==null?void 0:i.icon)||"üìä"}),e.jsxs("span",{className:"indicator-value",style:{color:i==null?void 0:i.color},children:[w,t]}),e.jsx("span",{className:"indicator-band-label",style:{color:i==null?void 0:i.color,backgroundColor:i==null?void 0:i.bgColor},children:(i==null?void 0:i.label)||"N/A"})]}),e.jsx("div",{className:"indicator-progress-container",children:e.jsx("div",{className:"indicator-progress-bar",style:{width:`${Math.max(0,A)}%`,backgroundColor:(i==null?void 0:i.color)||"var(--primary-blue)"}})}),h&&e.jsx("div",{className:"indicator-subtitle",children:h})]}),g&&p&&e.jsxs("div",{className:"indicator-info-panel",children:[e.jsxs("div",{className:"indicator-info-content",children:[e.jsx("p",{className:"indicator-info-description",children:i==null?void 0:i.description}),p]}),e.jsx("button",{className:"indicator-info-close",onClick:()=>j(!1),children:"‚úï"})]})]})}se.propTypes={title:f.string.isRequired,value:f.number,unit:f.string,band:f.shape({color:f.string,bgColor:f.string,label:f.string,description:f.string,icon:f.string}),min:f.number,max:f.number,subtitle:f.string,loading:f.bool,infoContent:f.node};function be({pressure:s,fmv:a,loading:t=!1}){const i=(s==null?void 0:s.value)??null,n=s==null?void 0:s.medianAsking,r=ae("pressure",i);let h="";n&&a&&(h=`Median asking: ${V(n)} vs FMV: ${V(a)}`);const c=e.jsxs("div",{className:"indicator-info-details",children:[e.jsx("h4",{children:"How Market Pressure is Calculated"}),e.jsx("p",{children:"Market Pressure = ((Median Asking Price - FMV) / FMV) √ó 100"}),e.jsx("h4",{children:"What It Means"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Negative:"})," Sellers pricing below FMV - good buying opportunity"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"0-15%:"})," Healthy market - prices align with recent sales"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"15-30%:"})," Sellers optimistic - expect negotiation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"30-50%:"})," Market resistance - many listings may not sell"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"50%+:"})," Unrealistic asks - wait for price drops"]})]}),e.jsx("h4",{children:"For Buyers"}),e.jsx("p",{children:"Lower pressure means better buying conditions. When pressure is high, make offers below asking price or wait for sellers to reduce prices."}),e.jsx("h4",{children:"For Sellers"}),e.jsx("p",{children:"High market pressure indicates your competition is pricing too high. Price competitively near FMV for faster sales."})]});return e.jsx(se,{title:"Market Pressure",value:i,unit:"%",band:r,min:-50,max:100,subtitle:h,loading:t,infoContent:c})}be.propTypes={pressure:f.shape({value:f.number,medianAsking:f.number}),fmv:f.number,loading:f.bool};function je({confidence:s,soldCount:a,loading:t=!1}){const i=(s==null?void 0:s.value)??null,n=s==null?void 0:s.stdDev,r=s==null?void 0:s.mean,h=ae("confidence",i);let c="";r&&n!==null&&n!==void 0?c=`Avg: ${V(r)} ¬± ${V(n)} (${a||0} sales)`:a&&(c=`Based on ${a} sales`);const p=e.jsxs("div",{className:"indicator-info-details",children:[e.jsx("h4",{children:"How Market Confidence is Calculated"}),e.jsx("p",{children:"Confidence = 100 / (1 + Coefficient of Variation / 100)"}),e.jsx("p",{children:"The Coefficient of Variation (CV) measures price spread relative to the average. Lower CV = more consistent prices = higher confidence."}),e.jsx("h4",{children:"What It Means"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"80-100:"})," Highly consistent - FMV is very reliable"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"60-80:"})," Good consistency - FMV is solid estimate"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"40-60:"})," Moderate - consider the price range"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"20-40:"})," Low - prices vary significantly"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"0-20:"})," Very low - wide price swings, FMV unreliable"]})]}),e.jsx("h4",{children:"Why It Matters"}),e.jsx("p",{children:"High confidence means you can trust the FMV estimate. Low confidence suggests the market hasn't agreed on a price - you might find bargains or overpay."}),e.jsx("h4",{children:"Improving Confidence"}),e.jsx("p",{children:"Try refining your search with more specific terms (e.g., add year, variation, or condition) to get more comparable sales."})]});return e.jsx(se,{title:"Market Confidence",value:i,unit:"/100",band:h,min:0,max:100,subtitle:c,loading:t,infoContent:p})}je.propTypes={confidence:f.shape({value:f.number,stdDev:f.number,mean:f.number}),soldCount:f.number,loading:f.bool};function ke({liquidity:s,soldCount:a,activeCount:t,loading:i=!1}){const n=(s==null?void 0:s.value)??null,r=s==null?void 0:s.ratio,h=ae("liquidity",n);let c="";if(a!==null&&t!==null){const g=r!==null?r.toFixed(2):"--";c=`${a} sold : ${t} active (${g}x)`}const p=e.jsxs("div",{className:"indicator-info-details",children:[e.jsx("h4",{children:"How Liquidity is Calculated"}),e.jsx("p",{children:"Absorption Ratio = Recent Sales / Active Listings"}),e.jsx("p",{children:"The score converts this ratio to a 0-100 scale where higher means faster-moving market."}),e.jsx("h4",{children:"What the Ratio Means"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"‚â• 1.0:"})," More sales than listings - high demand"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"0.5 - 1.0:"})," Balanced - healthy turnover"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"0.2 - 0.5:"})," Low - supply exceeds demand"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"< 0.2:"})," Very low - oversupplied market"]})]}),e.jsx("h4",{children:"For Buyers"}),e.jsx("p",{children:"Low liquidity means more negotiating power and less urgency. High liquidity means act fast on good deals."}),e.jsx("h4",{children:"For Sellers"}),e.jsx("p",{children:"High liquidity = price confidently, cards move quickly. Low liquidity = price competitively and be patient."}),e.jsx("h4",{children:"For Flippers"}),e.jsx("p",{children:"High liquidity is ideal - you can buy and resell quickly. Low liquidity means capital tied up longer."})]});return e.jsx(se,{title:"Liquidity Score",value:n,unit:"/100",band:h,min:0,max:100,subtitle:c,loading:i,infoContent:p})}ke.propTypes={liquidity:f.shape({value:f.number,ratio:f.number,band:f.string}),soldCount:f.number,activeCount:f.number,loading:f.bool};function ye({tier:s,advice:a,marketMessage:t,loading:i=!1}){return i?e.jsxs("div",{className:"market-assessment market-assessment-loading",children:[e.jsxs("div",{className:"assessment-header",children:[e.jsx("div",{className:"assessment-badge-skeleton"}),e.jsx("div",{className:"assessment-title-skeleton"})]}),e.jsx("div",{className:"assessment-body-skeleton"})]}):s?e.jsxs("div",{className:"market-assessment",children:[e.jsxs("div",{className:"assessment-header",children:[e.jsxs("span",{className:"tier-badge",style:{color:s.color,backgroundColor:s.bgColor,borderColor:s.color},children:[e.jsx("span",{className:"tier-icon",children:s.icon}),e.jsx("span",{className:"tier-label",children:s.label}),e.jsxs("span",{className:"tier-number",children:["Tier ",s.tier]})]}),e.jsx("h3",{className:"assessment-title",children:"Market Assessment"})]}),e.jsxs("div",{className:"assessment-description",children:[e.jsx("p",{children:s.description}),(t==null?void 0:t.message)&&e.jsx("p",{className:"assessment-api-message",children:t.message})]}),a&&e.jsxs("div",{className:"advice-sections",children:[a.collector&&e.jsxs("div",{className:"advice-section advice-collector",children:[e.jsxs("div",{className:"advice-header",children:[e.jsx("span",{className:"advice-icon",children:"üéØ"}),e.jsx("span",{className:"advice-label",children:"For Collectors"})]}),e.jsx("p",{className:"advice-text",children:a.collector})]}),a.seller&&e.jsxs("div",{className:"advice-section advice-seller",children:[e.jsxs("div",{className:"advice-header",children:[e.jsx("span",{className:"advice-icon",children:"üí∞"}),e.jsx("span",{className:"advice-label",children:"For Sellers"})]}),e.jsx("p",{className:"advice-text",children:a.seller})]}),a.flipper&&e.jsxs("div",{className:"advice-section advice-flipper",children:[e.jsxs("div",{className:"advice-header",children:[e.jsx("span",{className:"advice-icon",children:"üìà"}),e.jsx("span",{className:"advice-label",children:"For Flippers"})]}),e.jsx("p",{className:"advice-text",children:a.flipper})]})]}),(t==null?void 0:t.recommendations)&&e.jsxs("div",{className:"api-recommendations",children:[e.jsx("h4",{children:"Additional Insights"}),e.jsx("ul",{children:t.recommendations.map((n,r)=>e.jsx("li",{children:n},r))})]})]}):e.jsxs("div",{className:"market-assessment market-assessment-empty",children:[e.jsxs("div",{className:"assessment-header",children:[e.jsx("span",{className:"assessment-icon",children:"üìä"}),e.jsx("h3",{className:"assessment-title",children:"Market Assessment"})]}),e.jsx("p",{className:"assessment-empty-text",children:"Run a search to see market assessment"})]})}ye.propTypes={tier:f.shape({tier:f.number,label:f.string,color:f.string,bgColor:f.string,icon:f.string,description:f.string}),advice:f.shape({collector:f.string,seller:f.string,flipper:f.string}),marketMessage:f.shape({message:f.string,recommendations:f.arrayOf(f.string)}),loading:f.bool};function Ne({recommendations:s,fmv:a,loading:t=!1}){if(t)return e.jsxs("div",{className:"pricing-recommendations pricing-loading",children:[e.jsx("h3",{className:"pricing-title",children:"Pricing Recommendations"}),e.jsxs("div",{className:"pricing-skeleton",children:[e.jsx("div",{className:"pricing-item-skeleton"}),e.jsx("div",{className:"pricing-item-skeleton"}),e.jsx("div",{className:"pricing-item-skeleton"})]})]});if(!s||!a)return e.jsxs("div",{className:"pricing-recommendations pricing-empty",children:[e.jsx("h3",{className:"pricing-title",children:"Pricing Recommendations"}),e.jsx("p",{className:"pricing-empty-text",children:"Pricing recommendations will appear after a search with valid FMV data."})]});const{quickSale:i,target:n,patientSale:r,quickDiscount:h,patientPremium:c}=s,p=r-i,g=p>0?(n-i)/p*100:50;return e.jsxs("div",{className:"pricing-recommendations",children:[e.jsxs("h3",{className:"pricing-title",children:[e.jsx("span",{className:"pricing-icon",children:"üíµ"}),"Pricing Recommendations"]}),e.jsxs("div",{className:"pricing-range-visual",children:[e.jsxs("div",{className:"pricing-range-bar",children:[e.jsxs("div",{className:"pricing-marker pricing-marker-quick",style:{left:"0%"},children:[e.jsx("div",{className:"pricing-marker-line"}),e.jsx("div",{className:"pricing-marker-dot"})]}),e.jsxs("div",{className:"pricing-marker pricing-marker-target",style:{left:`${g}%`},children:[e.jsx("div",{className:"pricing-marker-line pricing-marker-line-target"}),e.jsx("div",{className:"pricing-marker-dot pricing-marker-dot-target"})]}),e.jsxs("div",{className:"pricing-marker pricing-marker-patient",style:{left:"100%"},children:[e.jsx("div",{className:"pricing-marker-line"}),e.jsx("div",{className:"pricing-marker-dot"})]}),e.jsx("div",{className:"pricing-range-fill"})]}),e.jsxs("div",{className:"pricing-range-labels",children:[e.jsx("span",{className:"pricing-range-label pricing-range-label-quick",children:"Quick"}),e.jsx("span",{className:"pricing-range-label pricing-range-label-target",children:"Target"}),e.jsx("span",{className:"pricing-range-label pricing-range-label-patient",children:"Patient"})]})]}),e.jsxs("div",{className:"pricing-cards",children:[e.jsxs("div",{className:"pricing-card pricing-card-quick",children:[e.jsxs("div",{className:"pricing-card-header",children:[e.jsx("span",{className:"pricing-card-icon",children:"‚ö°"}),e.jsx("span",{className:"pricing-card-label",children:"Quick Sale"})]}),e.jsx("div",{className:"pricing-card-value",children:V(i)}),e.jsxs("div",{className:"pricing-card-note",children:[h,"% below FMV"]}),e.jsx("div",{className:"pricing-card-description",children:"Price to sell within days. Best for moving inventory fast."})]}),e.jsxs("div",{className:"pricing-card pricing-card-target",children:[e.jsxs("div",{className:"pricing-card-header",children:[e.jsx("span",{className:"pricing-card-icon",children:"üéØ"}),e.jsx("span",{className:"pricing-card-label",children:"Target Price"})]}),e.jsx("div",{className:"pricing-card-value pricing-card-value-main",children:V(n)}),e.jsx("div",{className:"pricing-card-note",children:"Fair Market Value"}),e.jsx("div",{className:"pricing-card-description",children:"What comparable cards are actually selling for."})]}),e.jsxs("div",{className:"pricing-card pricing-card-patient",children:[e.jsxs("div",{className:"pricing-card-header",children:[e.jsx("span",{className:"pricing-card-icon",children:"‚è≥"}),e.jsx("span",{className:"pricing-card-label",children:"Patient Sale"})]}),e.jsx("div",{className:"pricing-card-value",children:V(r)}),e.jsxs("div",{className:"pricing-card-note",children:[c,"% above FMV"]}),e.jsx("div",{className:"pricing-card-description",children:"For patient sellers. May take weeks to find the right buyer."})]})]}),e.jsx("div",{className:"pricing-context",children:e.jsxs("p",{className:"pricing-context-text",children:[e.jsx("strong",{children:"Tip:"})," Prices adjust based on market conditions. High liquidity markets support higher asks; oversupplied markets need competitive pricing."]})})]})}Ne.propTypes={recommendations:f.shape({quickSale:f.number,target:f.number,patientSale:f.number,rangeMin:f.number,rangeMax:f.number,quickDiscount:f.number,patientPremium:f.number}),fmv:f.number,loading:f.bool};function Oe(){const{soldListings:s,activeListings:a,fmv:t,marketMetrics:i,marketTier:n,marketAdvice:r,pricingRecommendations:h,marketMessage:c,loadingMarketAnalysis:p,loading:g,loadingFmv:j,loadingActive:b,calculateMarketMetrics:A,fetchMarketMessage:w,hasResults:L}=q(u=>({soldListings:u.soldListings,activeListings:u.activeListings,fmv:u.fmv,marketMetrics:u.marketMetrics,marketTier:u.marketTier,marketAdvice:u.marketAdvice,pricingRecommendations:u.pricingRecommendations,marketMessage:u.marketMessage,loadingMarketAnalysis:u.loadingMarketAnalysis,loading:u.loading,loadingFmv:u.loadingFmv,loadingActive:u.loadingActive,calculateMarketMetrics:u.calculateMarketMetrics,fetchMarketMessage:u.fetchMarketMessage,hasResults:u.hasResults()}));if(k.useEffect(()=>{L&&!g&&!j&&!b&&!i&&(console.log("[AnalysisDashboard] Triggering market metrics calculation"),A())},[L,g,j,b,i,A]),k.useEffect(()=>{n&&t&&!c&&(console.log("[AnalysisDashboard] Fetching market message"),w())},[n,t,c,w]),!L)return null;const m=g||j||b||p,l=(t==null?void 0:t.market_value)||(t==null?void 0:t.expected_high);return e.jsxs("section",{className:"analysis-dashboard",children:[e.jsxs("div",{className:"analysis-dashboard-header",children:[e.jsxs("h2",{className:"analysis-dashboard-title",children:[e.jsx("span",{className:"analysis-icon",children:"üìä"}),"Market Analysis"]}),e.jsx("p",{className:"analysis-dashboard-subtitle",children:"Deep insights into market conditions and pricing"})]}),e.jsxs("div",{className:"analysis-indicators-grid",children:[e.jsx(be,{pressure:i==null?void 0:i.pressure,fmv:l,loading:m}),e.jsx(je,{confidence:i==null?void 0:i.confidence,soldCount:(s==null?void 0:s.length)||0,loading:m}),e.jsx(ke,{liquidity:i==null?void 0:i.liquidity,soldCount:(s==null?void 0:s.length)||0,activeCount:(a==null?void 0:a.length)||0,loading:m})]}),e.jsxs("div",{className:"analysis-details-grid",children:[e.jsx(ye,{tier:n,advice:r,marketMessage:c,loading:m}),e.jsx(Ne,{recommendations:h,fmv:l,loading:m})]})]})}function Ue(){const{loading:s,error:a,hasResults:t,clearError:i}=q(n=>({loading:n.loading,error:n.error,hasResults:n.hasResults(),clearError:n.clearError}));return e.jsxs("div",{className:"home-page",children:[e.jsx("section",{className:"search-section",children:e.jsx(me,{})}),a&&e.jsxs("div",{className:"error-banner",children:[e.jsx("span",{children:a}),e.jsx("button",{onClick:i,children:"Dismiss"})]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"stats-section",children:[e.jsx(pe,{}),e.jsx(fe,{})]}),e.jsxs("section",{className:"charts-section",children:[e.jsxs("div",{className:"chart-container",children:[e.jsx("h3",{children:"Price Distribution"}),e.jsx(Ge,{})]}),e.jsxs("div",{className:"chart-container",children:[e.jsx("h3",{children:"Volume Profile"}),e.jsx(ve,{})]})]}),e.jsx(Oe,{}),e.jsx("section",{className:"results-section",children:e.jsxs("div",{className:"results-tables",children:[e.jsxs("div",{className:"sold-listings-section",children:[e.jsx("h3",{children:"Sold Listings (Comps)"}),e.jsx(ue,{})]}),e.jsxs("div",{className:"active-listings-section",children:[e.jsx("h3",{children:"Active Listings"}),e.jsx(ge,{})]})]})})]}),!t&&!s&&e.jsxs("div",{className:"search-placeholder",children:[e.jsx("h2",{children:"Search for Sports Cards"}),e.jsx("p",{children:"Enter a card name to find sold comps and active listings"})]})]})}export{Ue as default};
//# sourceMappingURL=HomePage-lZOAmuXm.js.map
